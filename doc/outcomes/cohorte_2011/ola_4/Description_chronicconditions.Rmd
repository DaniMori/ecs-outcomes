---
title: "Edad con Salud -- cohort 2011 -- Wave 4 -- 'chronic conditions'" 
output:
  word_document:
   reference_docx: !expr ecs.data::get_pkg_docx_template()
bibliography: ../../../../www/Edad_con_salud_outcome_vars.bib 
csl: "`r ecs.data::get_proj_csl_file()`"
editor_options: 
  markdown:
    wrap: 80
params:
  test: true
  double-coding: false
---

```{r setup, include=FALSE}

library(Statamarkdown)

STATA_PATH <- r"(Program Files (x86)StataSE-64.exe)"


options(width = 88) 

knitr::opts_chunk$set( 
  echo        = FALSE, 
  results     = 'hide',
  cleanlog    = TRUE, 
  collectcode = TRUE,  
  comment     = ''     
)

TEST          <- params$test
DOUBLE_CODING <- params$`double-coding` & TEST
```

# Variable information

+-----------------+----------------------+-----------------+-----------------+
| Main variable   | Label                | Format          | Code            |
| name            |                      |                 |                 |
+:================+:=====================+:================+:================+
| arthritis_s3    | arthritis algorithm  | dummy           | 1 yes           |
|                 | test or              |                 |                 |
|                 | self-reported        |                 | 2 no            |
|                 | (c2011_w4)           |                 |                 |
+-----------------+----------------------+-----------------+-----------------+
| osteoart_s3     | osteoarthritis       | dummy           | 1 yes           |
|                 | algorithm test or    |                 |                 |
|                 | self-reported        |                 | 2 no            |
|                 | (c2011_w4)           |                 |                 |
+-----------------+----------------------+-----------------+-----------------+
| stroke_s3       | stroke algorithm     | dummy           | 1 yes           |
|                 | test or              |                 |                 |
|                 | self-reported        |                 | 2 no            |
|                 | (c2011_w4)           |                 |                 |
+-----------------+----------------------+-----------------+-----------------+
| angina_s3       | angina algorithm     | dummy           | 1 yes           |
|                 | test or              |                 |                 |
|                 | self-reported        |                 | 2 no            |
|                 | (c2011_w4)           |                 |                 |
+-----------------+----------------------+-----------------+-----------------+
| diab_s3         | diabetes self        | dummy           | 0 No            |
|                 | reported and         |                 |                 |
|                 | treatment (c2011_w4) |                 | 1 yes           |
|                 |                      |                 |                 |
|                 |                      |                 | 2 treatment     |
+-----------------+----------------------+-----------------+-----------------+
| lung_s3         | lung disease         | dummy           | 1 yes           |
|                 | algorithm test or    |                 |                 |
|                 | self-reported        |                 | 2 no            |
|                 | (c2011_w4)           |                 |                 |
+-----------------+----------------------+-----------------+-----------------+
| asthma_s3       | asthma algorithm     | dummy           | 1 yes           |
|                 | test or self         |                 |                 |
|                 | reported (c2011_w4)  |                 | 2 no            |
+-----------------+----------------------+-----------------+-----------------+
| hypertension_s3 | hypertension         | dummy           | 1 yes           |
|                 | algorithm test or    |                 |                 |
|                 | self reported        |                 | 2 no            |
|                 | (c2011_w4)           |                 |                 |
+-----------------+----------------------+-----------------+-----------------+
| cataracts_s3    | cataracts algorithm  | dummy           | 1 yes           |
|                 | test or self         |                 |                 |
|                 | reported (c2011_w4)  |                 | 2 no            |
+-----------------+----------------------+-----------------+-----------------+
| oral_s3         | oral problems        | dummy           | 1 yes           |
|                 | algorithm test or    |                 |                 |
|                 | self reported        |                 | 2 no            |
|                 | (c2011_w4)           |                 |                 |
+-----------------+----------------------+-----------------+-----------------+
| kidney_s3       | kidney self reported | dummy           | 0 no            |
|                 | and treatment        |                 |                 |
|                 | (c2011_w4)           |                 | 1 yes           |
|                 |                      |                 |                 |
|                 |                      |                 | 2 treatment     |
+-----------------+----------------------+-----------------+-----------------+
| digestive_s3    | digestive self       | dummy           | 0 no            |
|                 | reported and         |                 |                 |
|                 | treatment (c2011_w4) |                 | 1 yes           |
|                 |                      |                 |                 |
|                 |                      |                 | 2 treatment     |
+-----------------+----------------------+-----------------+-----------------+
| cancer_s3       | cancer self reported | dummy           | 1 yes           |
|                 | (c2011_w4)           |                 |                 |
|                 |                      |                 | 2 no            |
+-----------------+----------------------+-----------------+-----------------+
| liver_s3        | liver self reported  | dummy           | 0 no            |
|                 | and treatment        |                 |                 |
|                 | (c2011_w4)           |                 | 1 yes           |
|                 |                      |                 |                 |
|                 |                      |                 | 2 treatment     |
+-----------------+----------------------+-----------------+-----------------+
| osteop_s3       | osteoporosis self    | dummy           | 0 no            |
|                 | reported and         |                 |                 |
|                 | treatment (c2011_w4) |                 | 1 yes           |
|                 |                      |                 |                 |
|                 |                      |                 | 2 treatment     |
+-----------------+----------------------+-----------------+-----------------+
| anaemia_s3      | anaemia self         | dummy           | 0 no            |
|                 | reported and         |                 |                 |
|                 | treatment (c2011_w4) |                 | 1 yes           |
|                 |                      |                 |                 |
|                 |                      |                 | 2 treatment     |
+-----------------+----------------------+-----------------+-----------------+
| thyroid_s3      | thyroid self         | dummy           | 0 no            |
|                 | reported and         |                 |                 |
|                 | treatment (c2011_w4) |                 | 1 yes           |
|                 |                      |                 |                 |
|                 |                      |                 | 2 treatment     |
+-----------------+----------------------+-----------------+-----------------+
| glaucoma_s3     | glaucoma self        | dummy           | 0 no            |
|                 | reported and         |                 |                 |
|                 | treatment (c2011_w4) |                 | 1 yes           |
|                 |                      |                 |                 |
|                 |                      |                 | 2 treatment     |
+-----------------+----------------------+-----------------+-----------------+
| heart_s3        | heart self reported  | dummy           | 1 yes           |
|                 | (c2011_w4)           |                 |                 |
|                 |                      |                 | 2 no            |
+-----------------+----------------------+-----------------+-----------------+
| migr_s3         | Migraine self        | dummy           | 0 no            |
|                 | reported and         |                 |                 |
|                 | treatment (c2011_w4) |                 | 1 yes           |
|                 |                      |                 |                 |
|                 |                      |                 | 2 treatment     |
+-----------------+----------------------+-----------------+-----------------+
| lowback_s3      | Chronic Back Pain    | dummy           | 0 no            |
|                 | self-reported and    |                 |                 |
|                 | treatment (c2011_w4) |                 | 1 yes           |
|                 |                      |                 |                 |
|                 |                      |                 | 2 treatment     |
+-----------------+----------------------+-----------------+-----------------+
| dem_s3          | Dementia self        | dummy           | 0 no            |
|                 | reported and         |                 |                 |
|                 | treatment (c2011_w4) |                 | 1 yes           |
|                 |                      |                 |                 |
|                 |                      |                 | 2 treatment     |
+-----------------+----------------------+-----------------+-----------------+

# Variables description

General comment: Chronic condition algorithms were developed for the World
Health Survey [@worldhe]and adapted from COURAGE [@courage]. Symptom-based
estimates were prepared for the following conditions: arthritis, stroke, angina,
lung disease, asthma and hypertension. In such cases, the algorithm reflects a
specific response pattern or a combination of answers indicating whether someone
has a disease (see explanations below) in the previous 12 months. All other
response patterns (i.e. one or more no's) will result in 'no disease'.
Additionally, self-reported diagnoses (ever diagnosed) were included in all
chronic conditions.

Important note: In "Edad con Salud" we have created an option (i.e. var_a =997)
for those individuals who reported a disease in first assessment, but in second
assessment they said that they have never had such disease. There are ≈10-20
individuals per disease that have reported this situation. We have considered
this circumstance in the self-reported algorithms presented below (i.e. those
who said 997 have been considered as not having the disease). This condition
applies for all the diagnoses.

## Arthritis

Rheumatoid Arthritis is a chronic systemic disease that affects the joints,
connective tissues, muscle, tendons, and fibrous tissue. It tends to strike
during the most productive years of adulthood, between the ages of 20 and 40,
and is a chronic disabling condition often causing pain and deformity.
Osteoarthritis is a degenerative joint disease, which mainly affects the
articular cartilage. It is associated with ageing and will most likely affect
the joints that have been continually stressed throughout the years including
the knees, hips, fingers, and lower spine region.

## Stroke

A stroke is caused by the interruption of the blood supply to the brain, usually
because a blood vessel bursts or is blocked by a clot. This cuts off the supply
of oxygen and nutrients, causing damage to the brain tissue.

## Angina

Angina is a chest pain that occurs when the blood supply to the muscles of the
heart is restricted. It usually happens because the arteries supplying the heart
become hardened and narrowed.

## Diabetes

Diabetes is a chronic, metabolic disease characterized by elevated levels of
blood glucose (or blood sugar), which leads over time to serious damage to the
heart, blood vessels, eyes, kidneys, and nerves. The most common is type 2
diabetes, usually in adults, which occurs when the body becomes resistant to
insulin or doesn't make enough insulin.

## Lung Disease

Lung disease is any problem in the lungs that prevents the lungs from working
properly. There are three main types of lung disease: a) airway diseases, that
affect the tubes (airways) that carry oxygen and other gases into and out of the
lungs; b) Lung tissue diseases, affecting the structure of the lung tissue; and
c) Lung circulation diseases, that affect the blood vessels in the lungs.

## Asthma

Asthma is a chronic disease characterized by recurrent attacks of breathlessness
and wheezing, which vary in severity and frequency from person to person. During
an asthma attack, the lining of the bronchial tubes swells, causing the airways
to narrow and reducing the flow of air into and out of the lungs.

## Hypertension

Hypertension, also known as high or raised blood pressure, is a condition in
which the blood vessels have persistently raised pressure. Blood is carried from
the heart to all parts of the body in the vessels. Each time the heart beats, it
pumps blood into the vessels. Blood pressure is created by the force of blood
pushing against the walls of blood vessels (arteries) as it is pumped by the
heart. The higher the pressure the harder the heart has to pump.

## Cataracts

A cataract is clouding of the lens of the eye, which impedes the passage of
light. Most cataracts are related to ageing, although occasionally children may
be born with the condition, or cataract may develop after an injury,
inflammation or disease.

## Oral Health

Oral health is essential to general health and quality of life. It is a state of
being free from mouth and facial pain, oral and throat cancer, oral infection
and sores, periodontal (gum) disease, tooth decay, tooth loss, and other
diseases and disorders that limit an individual's capacity in biting, chewing,
smiling, speaking, and psychosocial wellbeing. Risk factors for oral diseases
include an unhealthy diet, tobacco use and harmful alcohol use.

## Kidney Disease

Chronic kidney disease includes complications like high blood pressure, anaemia,
weak bones, poor nutritional health and nerve damage. It may be caused by
diabetes, high blood pressure and other disorders.

## Digestive Disease

A digestive disease is any health problem that occurs in the digestive tract,
and may range from mild to serious conditions. Some common problems include
cancer, irritable bowel syndrome, and lactose intolerance.

## Cancer

Cancer is a generic term for a large group of diseases that can affect any part
of the body. One defining feature of cancer is the rapid creation of abnormal
cells that grow beyond their usual boundaries, and which can then invade
adjoining parts of the body and spread to other organs, the latter process is
referred to as metastasizing.

## Liver Disease

There are diverse kinds of liver diseases that difficult the process of
digestion, store energy, or poisons removal. Viruses cause some of them (i.e.
hepatitis A, hepatitis B and hepatitis C), while others can be the result of
drugs, poisons or drinking too much alcohol.

## Osteoporosis

Osteoporosis is a disease in which the density and quality of bone are reduced.
As bones become more porous and fragile, the risk of fracture is greatly
increased. The loss of bone occurs silently and progressively.

## Anaemia

Anaemia is a condition in which the number of red blood cells or their
oxygen-carrying capacity is insufficient to meet physiologic needs, which vary
by age, sex, altitude, smoking, and pregnancy status.

## Thyroid

The thyroid gland is an endocrine gland in the neck. It makes two hormones that
are secreted into the blood: thyroxine (T4) and triodothyronine (T3). These
hormones are necessary for all the cells in the body to work normally. Thyroid
disorders are very common and tend mainly to occur in women. If too much of the
thyroid hormones are secreted (hyperthyroid), the body cells work faster than
normal, and this increased activity may lead to a quickening of your heart rate
or increased activity of the intestine. If too little of the thyroid hormones
are produced (hypothyroidism), the cells and organs of your body slow down. In
that case, the heart rate, for example, may be slower than normal and the
intestines work sluggishly.

## Glaucoma

Glaucoma is the general term for a group of similar diseases. In primary open
angle glaucoma, the channels that drain fluid within the eye become blocked,
causing the pressure within the eye to rise. It causes gradual loss of vision.
There are few symptoms so that people may not notice for a long time that they
are losing their sight.

## Heart Disease

Cardiovascular diseases are disorders of the heart and blood vessels and include
coronary heart disease, cerebrovascular disease, rheumatic heart disease and
other conditions. Four out of five CVD deaths are due to heart attacks and
strokes. Individuals at risk of CVD may demonstrate raised blood pressure,
glucose, and lipids as well as overweight and obesity.

## Migraine

Migraine is a primary headache disorder and it is caused by the activation of a
mechanism deep in the brain that leads to release of pain-producing inflammatory
substances around the nerves and blood vessels of the head. A large number of
people with headache disorders are not diagnosed and treated: worldwide only 40%
of those with migraine are professionally diagnosed. In the Global Burden of
Disease Study of 2016, migraine affected more than one billion people globally,
caused 45 million years lost due to disability (YLDs) and was the second most
disabling condition worldwide. Among young adults (under 50 years of age), it
was the most disabling.

## Chronic Back Pain

Chronic back pain is defined as pain that continues for 12 weeks or longer. It
has been found to be the leading cause of disability when analysed globally and
has remained one of the top 2 contributors of global disability causes for over
two decades. Chronic low back pain: About 20 percent of people affected by acute
low back pain develop chronic low back pain with persistent symptoms at one
year. Chronic cervical, neck or upper-back pain: Although most acute episodes
resolve spontaneously, more than a third of affected people still have low grade
symptoms or recurrences more than one year later, with genetics and psychosocial
factors being risk factors for persistence.

## Dementia

Dementia is a syndrome in which there is deterioration in cognitive function
(i.e. the ability to process thought) beyond what might be expected from normal
ageing. It affects memory, thinking, orientation, comprehension, calculation,
learning capacity, language, and judgement. The impairment in cognitive function
is commonly accompanied, and occasionally preceded, by changes in mood,
emotional control, behaviour, or motivation. Dementia results from a variety of
diseases and injuries that primarily or secondarily affect the brain, such as
Alzheimer's disease or stroke.

# Explanation of how the variables were created

## Arthritis

A diagnosis of arthritis was made if the participant fulfilled any of the
available criteria: (1) self-reported diagnosis of arthritis
(q4001_arthritis_s3); (2) self-reported symptoms of arthritis
(q4003_symptoms_s3, q4004_symptoms_s3,); (3) self-reported as under treatment
for arthritis (q4002b_treated_s3) and characteristics like duration
(q4005_duration_s3 and q4006_outcome_s3) As for the self-reported diagnosis,
arthritis was endorsed if the participant answered "yes" (1) to self-reported
diagnosis of arthritis, but if they affirmed they had never had the disease (not
"997" to q4001a_s3).

## Stroke

A diagnosis of stroke was made if the participant (1) self-reported the
diagnosis of a stroke (q4010_stroke_s3) or (2) suffer from two symptoms: a
sudden paralysis or weakness in arms or legs on one side of the body and a
sudden loss of sensation on one side of the body (q4012_parals_s3,
q4013_feeling_s3).

## Angina

A diagnosis of angina was made if the participant self reported suffering from
angina (q4014_angina_s3) or if he presents several symptoms such as chest pain
when walking downhill, chest pain when walking normally, etc.
(q4016_symptoms_s3, q4017_symptoms_s3, q4018_r, q4019_s, q4020_where_6\_s3,
q4020_where_7\_s3, q4020_where_8\_s3, q4020_where_11_s3) Diagnosis of angina was
endorsed if the participant answered "yes" (1) to self-reported diagnosis , but
not if they affirmed they had never had the disease (not "997" to
q4014_angina_s3).

## Diabetes

Original variables include the self-reported diagnosis of diabetes
(q4022_diabetes_s3), the self-reported treatment of diabetes (q4023b_treated_s3)
and the following of a special diet (q4024_diet_s3). Diabetes was endorsed when
the participant answered "yes" to self-reported diagnose of diabetes, but not
997 in q4022a_s3 (they affirmed they had never had the disease).

## Lung Disease

A diagnosis of lung disease was made if the participant fulfilled any of the
available criteria (i.e. self-reported diagnosis or symptoms). Those
participants who answered "yes" to q4027_symptoms_s3, q4028_symptoms_s3 and
q4029_symptoms_s3, were defined as having had lung disease. As for the
self-reported diagnosis, lung disease was endorsed if the participant answered
"yes" to q4025_lungs_s3, but not 997 in q4025a_s3 (they affirmed they had never
had the disease). Please, consider that this algorithm does not include asthma
as a part of lung diseases.

## Asthma

A diagnosis of asthma was made if the participant has self-reported having the
diases (q4033_asthma_s3) or if he is treated for asthma (q4034b_treated_s3) or
several symptoms such as (1) wheezing attacks (q4035_symptoms_s3), (2) wheezing
attack immediately after physical activity (q4036_symptoms_s3), (3) feeling of
tightness in the chest (q4037_symptoms_s3), (4) woken up with a tight feeling in
chest (q4038_symptoms_s3), (5) attack of shortness of breath, which occurs
without an obvious cause (q4039_symptoms_s3). Those participants who answered
"yes" to all five symptoms were defined as having had asthma. As for the
self-reported diagnosis, asthma was endorsed if the participant answered "yes"
to q4033_asthma_s3, but not 997 in q4033a_s3 (they affirmed they had never had
the disease). Note: it is possible to create the symptom algorithm in a less
conservative way. That is: if q4035_symptoms_s3=1 and q4036_symptoms_s3=1 or
q4037_symptoms_s3=1\
or q4038_symptoms_s3=1 or q4039_symptoms_s3=1, asthma_test=1. There is,
apparently, no wrong or right option.

## Hypertension

Those participants with systolic blood pressure ≥140 mmHg (q2501_syst_s3,
q2502_syst_s3, measured twice) and/or diastolic blood pressure ≥90 mmHg
(q2501_diast_s3, q2502_diast_s3, measured twice) were considered to have
hypertension (blood pressure measurement). Hypertension diagonisis was also
assess if participan answer "yes" to the self-reported question about the
condition (q4060_high_bp_s3) but not "997" (they affirmed they had never had the
disease).

## Cataracts

A diagnosis of cataracts was made if the participant says he has the condition
(q4062_catar_s3) or if he suffer from those two symptoms: (1) blurred or hazy
vision (q4064_vision_s3) and (2) visual problems with light (q4065_light_s3) or
if he has undergone surgery (q4063_surgery_s3).We also included a treatment code
(cataracts_self=2) in those individuals who, apart from having reported a
cataract diagnosis, have had surgery for cataracts in the previous 12 months.

## Oral Health

Oral problems were endorsed if the participant answered "yes" to the
self-reported question about any oral conditions (q4067_symptoms_s3) or has been
pharmacology treated for oral problem (q4068b_treated_s3). We also consider the
age at which the participants lost all their teeth (q4066_teeth_s3). Those
participants who answered "yes" to q4066_teeth_s3, but not 997 in q4066a_s3
(they affirmed they had never lost their tooth) were defined as having had total
tooth loss. As for the self-reported symptoms, oral problems were endorsed if
the participant answered "yes" to q4067_symptoms_s3.

## Kidney Disease

A diagnosis of kidney disease was endorsed if the participant self-reported
having a kidney diases (q4085_kidney_s3). Treatment taken for kidney disease
have also been taken into acount (q4086_s3).

## Digestive Disease

A diagnosis of digestive disease was endorsed if the participant self-reported
having a kidney diases (q4087_s3). Treatment taken for digestive disease have
also been taken into acount (q4088_s3).

## Cancer

A diagnosis of cancer disease was endorsed if the participant answered "yes" to
self-reported question about cancer (q4089_s3).

## Liver Disease

A diagnosis of liver disease was endorsed if the participant self-reported
having a kidney diases (q4091_s3). Treatment taken for liver disease have also
been taken into acount (q4092_s3).

## Osteoporosis

A diagnosis of osteoporosis was endorsed if the participant self-reported having
a kidney diases (q4093_s3). Treatment taken for osteoporosis have also been
taken into acount (q4094_s3).

## Anaemia

A diagnosis of anaemia was endorsed if the participant self-reported having a
kidney diases (q4095_s3). Treatment taken for anaemia have also been taken into
acount (q4096_s3).

## Thyroid

A diagnosis of hyperthyroid or hypothyroid was endorsed if the participant
self-reported having a kidney diases (q4097_s3). Treatment taken for tyroid
condition have also been taken into acount (q4098_s3).

## Glaucoma

A diagnosis of glaucoma was endorsed if the participant self-reported having a
kidney diases (q4099_s3). Treatment taken for glaucoma have also been taken into
acount (q4100_s3).

## Heart Disease

A diagnosis of heart disease was endorsed if the participant self-reported
having a kidney diases (q4101_s3). Treatment taken for heart disease have also
been taken into acount (q4102_s3).

## Migraine

Original variables include self-reported diagnose (q4119) and treatment
(q4119c). A diagnosis of migraine was endorsed if the participant answered "yes"
to q4119. We also included a treatment code (migr_self=2) in those individuals
who reported migraine and received treatment for it in the previous 12 months.

## Chronic Back pain

Diagnosis of chronic low back pain were made if the participant self-reported
chronic back pain (q4112). Treatment taken for chronic low back pain have also
been taken into acount (q4113c).

## Dementia

Original variables include question about previous diagnose of dementia (q4105)
and treatment (q4106c). A diagnosis of dementia was endorsed if the participant
answered "yes" to q4105. We also included a treatment code (dem_self=2) in those
individuals who reported dementia and received treatment for it in the previous
12 months.

# Syntax used to create the variable (Stata 15)

```{stata load-data}

* Cohorte 2011, ola 4:
use "~\UAM\Marta Miret Garcia - Bases de datos maestras Edad con Salud\Ola_4\Cohorte 2011\rawdata_c2011w4.dta"
```

```{stata generate-outcomes, echo=!DOUBLE_CODING}
*ARTHRITIS
* Symptoms for arthritis.
gen art_test_s3=.
replace art_test_s3=1 if q4003_symptoms_s3==1 & q4004_symptoms_s3==1 & q4005_duration_s3==2 & q4006_outcome_s3==1
replace art_test_s3=2 if q4003_symptoms_s3==2 | q4004_symptoms_s3==2 | q4005_duration_s3==1 | q4006_outcome_s3==2
label define labels1 1 "Yes" 2 "No"
label values art_test_s3 labels1
label variable art_test_s3 "test for arthritis"
* Arthritis self-reported. 
recode q4001_arthritis_s3 (888=.), gen (art_1)
recode q4002c_treated_s3 (888=.), gen (art_2)
replace art_1=2 if q4001a_s3==997
gen art_self_s3=.
replace art_self_s3=2 if art_1==2
replace art_self_s3=1 if art_1==1
label values art_self_s3 labels1
label variable art_self_s3 "Arthritis self-reported"
* Final algorithm for arthritis (without treatment).
gen arthritis_s3=.
replace arthritis_s3=1 if (art_test_s3==1 | art_self_s3==1) | (art_test_s3==. & art_self_s3==1) | (art_test_s3==1 & art_self_s3==.)  
replace arthritis_s3=2 if art_test_s3==2 & art_self_s3==2
label values arthritis_s3 labels1
label variable arthritis_s3 "Arthritis test or self-reported"


*OSTEOARTHRITIS
* Symptoms for osteoarthritis.
gen osteoart_test_s3=.
replace osteoart_test_s3=1 if q4003_symptoms_s3==1 & q4005_duration_s3==1 & q4005_duration_s3==1 & q4006_outcome_s3==2
replace osteoart_test_s3=2 if q4003_symptoms_s3==2 | q4005_duration_s3==2 | q4005_duration_s3==2 | q4006_outcome_s3==1
label values osteoart_test_s3 labels1
label variable osteoart_test_s3 "Osteoarthritis test"
* Final algorithm for osteoarthritis.
gen osteoart_s3=.
replace osteoart_s3=1 if (osteoart_test_s3==1 | art_self_s3==1) | (osteoart_test_s3==. & art_self_s3==1) | (osteoart_test_s3==1 & art_self_s3==.)  
replace osteoart_s3=2 if osteoart_test_s3==2 & art_self_s3==2
label values osteoart_s3 labels1
label variable osteoart_s3 "Osteoarthritis test or self-reported"


*STROKE.
* Symptoms for stroke.
gen stroke_test_s3=.
replace stroke_test_s3=1 if q4012_paral_s3==1 & q4013_feeling_s3==1
replace stroke_test_s3=2 if q4012_paral_s3==2 | q4013_feeling_s3==2
label values stroke_test_s3 labels1
label variable stroke_test_s3 "Stroke test"
* Stroke self-reported.
recode q4010_stroke_s3 (888=.), gen (str_1)
replace str_1=2 if q4010a_s3==997
gen str_self_s3=.
replace str_self_s3=1 if str_1==1
replace str_self_s3=2 if str_1==2
label values str_self_s3 labels1
label variable str_self_s3 "Stroke self-reported"
* Final algorithm for stroke.
gen stroke_s3=.
replace stroke_s3=1 if stroke_test_s3==1 | str_self_s3==1
replace stroke_s3=2 if stroke_test_s3==2 & str_self_s3==2
label values stroke_s3 labels1
label variable stroke_s3 "Stroke self-reported or test"


*ANGINA. 
* Symptoms for angina. 
recode q4016_symptoms_s3 (3=2), gen (q4016_s)
rename q4017_symptoms_s3 q4017_s
recode q4018_resp_s3 (1=1) (2=1) (3=2), gen (q4018_r)
recode q4019_stand_s3 (888=.), gen (q4019_s)
replace q4018_r=9 if q4017_s==2
replace q4019_s=9 if q4017_s==2
gen angina_test_s3=2
replace angina_test_s3=1 if (q4016_s==1 | q4017_s==1) & q4018_r==1 & q4019_s==1 & (q4020_where_6_s3==1 | q4020_where_8_s3==1 | q4020_where_8_s3==1 | q4020_where_11_s3==1)
replace angina_test_s3=. if q4016_s==. | q4017_s==. | q4018_r==. | q4019_s==.
label values angina_test_s3 labels1
label variable angina_test_s3 "Angina test"
* Angina self-reported. 
recode q4014_angina_s3 (888=.), gen (ang_1)
replace ang_1=2 if q4014a_s3==997
gen ang_self_s3=.
replace ang_self_s3=1 if ang_1==1
replace ang_self_s3=2 if ang_1==2
label values ang_self_s3 labels1
label variable ang_self_s3 "Angina self-reported"
* Final algorithm for angina. 
gen angina_s3=2
replace angina_s3=1 if angina_test_s3==1 | ang_self_s3==1
replace angina_s3=. if angina_test_s3==. & ang_self_s3==.
label values angina_s3 labels1
label variable angina_s3 "Angina test or self-reported"


* DIABETES.
* Diabetes self-reported.
recode q4022_diabetes_s3 (888=.), gen (diab_self_s3)
replace diab_self_s3=2 if q4022a_s3==997
label values diab_self_s3 labels1
label variable diab_self_s3 "Diabetes self-reported"
recode q4023b_treated (888=.) (2=0), gen (diab_treatment_s3)
label values diab_treatment_s3 labels1
label variable diab_treatment_s3 "Treatment for diabetes"
gen diab_s3=.
replace diab_s3=0 if diab_self_s3==0
replace diab_s3=1 if diab_self_s3==1 
replace diab_s3=2 if diab_self_s3==1 & diab_treatment_s3==1
label define labels2 0 "No" 1 "Self-reported" 2 "Treatment"
label values diab_s3 labels2
label variable diab_s3 "Diabetes self-reported and treatment"


* LUNG DISEASE 
* Symptoms for lung disease.
gen lung_test_s3=.
replace lung_test_s3=1 if q4027_symptoms_s3==1 & q4028_symptoms_s3==1 & q4029_symptoms_s3==1
replace lung_test_s3=2 if q4027_symptoms_s3==2 | q4028_symptoms_s3==2 | q4029_symptoms_s3==2
label values lung_test_s3 labels1
label variable lung_test_s3 "Lung Disease test"
* Lung disease self-reported.
recode q4025_lungs_s3 (888=.), gen (lu_1)
replace lu_1=2 if q4025a_s3==997
ren lu_1 lung_self_s3
label values lung_self_s3 labels1
label variable lung_self_s3 "Lung Disease self-reported"
* Final algorithm for lung disease.
gen lung_s3=.
replace lung_s3=1 if lung_test_s3==1 | lung_self_s3 ==1
replace lung_s3=2 if lung_test_s3==2 & lung_self_s3 ==2
label values lung_s3 labels1
label variable lung_s3 "Lung Disease test or self-reported"


*ASTHMA. 
* Symptoms for asthma. 
gen asthma_test_s3=.
replace asthma_test_s3=1 if (q4035_symptoms_s3==1 & q4036_symptoms_s3==1 & q4037_symptoms_s3==1 & q4038_symptoms_s3==1 & q4039_symptoms_s3==1)
replace asthma_test_s3=2 if (q4035_symptoms_s3==2 | q4036_symptoms_s3==2 | q4037_symptoms_s3==2 | q4038_symptoms_s3==2 | q4039_symptoms_s3==2)
label values asthma_test_s3 labels1
label variable asthma_test_s3 "Asthma test"
* Asthma self-reported. 
recode q4033_asthma_s3 (888=.), gen (ast_1)
replace ast_1=2 if q4033a_s3==997
ren ast_1 ast_self_s3
label values ast_self_s3 labels1
label variable ast_self_s3 "Asthma self-reported"
* Final algorithm for asthma. 
gen asthma_s3=.
replace asthma_s3=1 if asthma_test_s3==1 | ast_self_s3==1
replace asthma_s3=2 if asthma_test_s3==2 & ast_self_s3==2
label values asthma_s3 labels1
label variable asthma_s3 "Asthma test or self-reported"


* HYPERTENSION.
* Test for hypertension. 
recode q2501_syst_s3 (997=.) (998=.), gen (q2501_s)
recode q2502_syst_s3 (997=.) (998=.), gen (q2502_s)
recode q2501_diast_s3 (997=.) (998=.), gen (q2501_d)
recode q2502_diast_s3 (997=.) (998=.), gen (q2502_d)
egen systolic= rowmean(q2501_s q2502_s)
replace systolic=q2501_s if q2501_s!=. & q2502_s==.
replace systolic=q2502_s if q2501_s==. & q2502_s!=.
egen diastolic= rowmean(q2501_d q2502_d)
replace diastolic =q2501_d if q2501_d!=. & q2502_d==.
replace diastolic =q2502_d if q2501_d==. & q2502_d!=.
gen hypertension_test_s3=.
replace hypertension_test_s3=1 if systolic>=140 | diastolic>=90 
replace hypertension_test_s3=2 if systolic<140 & diastolic<90 
replace hypertension_test_s3=. if systolic==. | diastolic==.
label values hypertension_test_s3 labels1
label variable hypertension_test_s3 "Hypertension test"
* Hypertension self-reported.
recode q4060_high_bp_s3 (888=.), gen (hyp_1)
replace hyp_1=2 if q4060a_s3==997
ren hyp_1 hyper_self_s3
label values hyper_self_s3 labels1
label variable hyper_self_s3 "Hypertension self-reported"
* Final algorithm for hypertension.
gen hypertension_s3=.
replace hypertension_s3=1 if hypertension_test_s3==1 | hyper_self_s3 ==1
replace hypertension_s3=2 if hypertension_test_s3==2 & hyper_self_s3 ==2
label values hypertension_s3 labels1
label variable hypertension_s3 "Hypertension test or self-reported"


* CATARACTS.
recode q4062_catar_s3 (888=.), gen (catar_self_s3)
gen catar_test_s3=.
replace catar_test_s3=1 if q4064_vision_s3==1 & q4065_light_s3==1
replace catar_test_s3=2 if q4064_vision_s3==2 | q4065_light_s3==2
label values catar_test_s3 labels1
label variable catar_test_s3 "Cataract test"
label values catar_self_s3 labels1
label variable catar_self_s3 "Cataract self-reported"
* Final algorithm for cataracts.
gen cataracts_s3=.
replace cataracts_s3=1 if catar_self_s3==1 | catar_test_s3==1
replace cataracts_s3=2 if catar_self_s3==2 & catar_test_s3==2
label values cataracts_s3 labels1
label variable cataracts_s3 "Cataract test or self-reported"


* ORAL HEALTH.
recode q4066_teeth_s3 (888=.), gen (oral_self_s3)
recode q4067_symptoms_s3 (888=.), gen (oral_test_s3)
replace oral_self_s3=2 if q4066a_s3==997
label values oral_self_s3 labels1
label variable oral_self_s3 "Oral problems self-reported"
label values oral_test_s3 labels1
label variable oral_test_s3 "Oral problems test"
* Final algorithm for oral problems.
gen oral_s3=.
replace oral_s3=1 if oral_self_s3==1 | oral_test_s3==1
replace oral_s3=2 if oral_self_s3==2 & oral_test_s3==2
label values oral_s3 labels1
label variable oral_s3 "Oral problems test or self-reported"


* KIDNEY.
recode q4085_s3 (888=.), gen (kidney_self_s3)
replace kidney_self_s3=2 if q4085a_s3==997
label values kidney_self_s3 labels1
label variable kidney_self_s3 "Kidney problems self-reported"
recode q4086c (888=.) (2=0), gen (kidney_treatment_s3)
label values kidney_treatment_s3 labels1
label variable kidney_treatment_s3 "Treatment for kidney disease"
gen kidney_s3=.
replace kidney_s3=0 if kidney_self_s3 ==0
replace kidney_s3=1 if kidney_self_s3==1 
replace kidney_s3=2 if kidney_self_s3==1 & kidney_treatment_s3==1
label values kidney_s3 labels2
label variable kidney_s3 "Kidney disease self-reported or treatment"


* DIGESTIVE.
recode q4087_s3 (888=.), gen (digestive_self_s3)
replace digestive_self_s3=2 if q4087a_s3==997
label values digestive_self_s3 labels1
label variable digestive_self "Digestive problems self-reported"
recode q4088c (888=.) (2=0), gen (digestive_treatment_s3)
label values digestive_treatment_s3 labels1
label variable digestive_treatment_s3 "Treatment for digestive disease"
gen digestive_s3=.
replace digestive_s3=0 if digestive_self_s3==0
replace digestive_s3=1 if digestive_self_s3==1 
replace digestive_s3=2 if digestive_self_s3==1 & digestive_treatment_s3==1
label values digestive_s3 labels2
label variable digestive_s3 "Digestive problems self-reported and treatment"

* CANCER.
recode q4089_s3 (888=.), gen (cancer_s3)
replace cancer_s3=2 if q4089a_s3==997
label values cancer_s3 labels1
label variable cancer_s3 "Cancer self-reported"


* LIVER.
recode q4091_s3 (888=.), gen (liver_self_s3)
replace liver_self_s3=2 if q4091a_s3==997
label values liver_self_s3 labels1
label variable liver_self_s3 "Liver self-reported"
recode q4092c (888=.) (2=0), gen (liver_treatment_s3)
label values liver_treatment_s3 labels1
label variable liver_treatment_s3 "Treatment for liver"
gen liver_s3=.
replace liver_s3=0 if liver_self_s3==0
replace liver_s3=1 if liver_self_s3==1 
replace liver_s3=2 if liver_self_s3==1 & liver_treatment_s3==1
label values liver_s3 labels2
label variable liver_s3 "Liver disease self-reported and treatment"

* OSTEOPOROSIS.
recode q4093_s3 (888=.), gen (osteop_self_s3)
replace osteop_self_s3=2 if q4093a_s3==997
label values osteop_self_s3 labels1
label variable osteop_self_s3 "Osteoporosis self-reported"
recode q4094c (888=.) (2=0), gen (osteop_treatment_s3)
label values osteop_treatment_s3 labels1
label variable osteop_treatment_s3 "Treatment for osteoporosis"
gen osteop_s3=.
replace osteop_s3=0 if osteop_self_s3==0
replace osteop_s3=1 if osteop_self_s3==1 
replace osteop_s3=2 if osteop_self_s3==1 & osteop_treatment_s3==1
label values osteop_s3 labels2
label variable osteop_s3 "Osteoporosis self-reported and treatment"

* ANAEMIA.
recode q4095_s3 (888=.), gen (anaemia_self_s3)
replace anaemia_self_s3=2 if q4095a_s3==997
label values anaemia_self_s3 labels1
label variable anaemia_self_s3 "Anaemia self-reported"
recode q4096c (888=.) (2=0), gen (anaemia_treatment_s3)
label values anaemia_treatment_s3 labels1
label variable anaemia_treatment_s3 "Treatment for anaemia"
gen anaemia_s3=.
replace anaemia_s3=0 if anaemia_self_s3==0
replace anaemia_s3=1 if anaemia_self_s3==1 
replace anaemia_s3=2 if anaemia_self_s3==1 & anaemia_treatment_s3==1
label values anaemia_s3 labels2
label variable anaemia_s3 "Anaemia self-reported and treatment"


* THYROID.
recode q4097_s3 (888=.), gen (thyroid_self_s3)
replace thyroid_self_s3=2 if q4097a_s3==997
label values thyroid_self_s3 labels1
label variable thyroid_self_s3 "Thyroid disease self-reported"
recode q4098c (888=.) (2=0), gen (thyroid_treatment_s3)
label values thyroid_treatment_s3 labels1
label variable thyroid_treatment_s3 "Treatment for thyroid"
gen thyroid_s3=.
replace thyroid_s3=0 if thyroid_self_s3==0
replace thyroid_s3=1 if thyroid_self_s3==1 
replace thyroid_s3=2 if thyroid_self_s3==1 & thyroid_treatment_s3==1
label values thyroid_s3 labels2
label variable thyroid_s3 "Thyroid self-reported and treatment"

* GLAUCOMA.
recode q4099_s3 (888=.), gen (glaucoma_self_s3)
replace glaucoma_self_s3=2 if q4099a_s3==997
label values glaucoma_self_s3 labels1
label variable glaucoma_self_s3 "Glaucoma self-reported"
recode q4100c (888=.) (2=0), gen (glaucoma_treatment_s3)
label values glaucoma_treatment_s3 labels1
label variable glaucoma_treatment_s3 "Treatment for glaucoma"
gen glaucoma_s3=.
replace glaucoma_s3=0 if glaucoma_self_s3==0
replace glaucoma_s3=1 if glaucoma_self_s3==1 
replace glaucoma_s3=2 if glaucoma_self_s3==1 & glaucoma_treatment_s3==1
label values glaucoma_s3 labels2
label variable glaucoma_s3 "Glaucoma self-reported and treatment"

* HEART CONDITIONS.
recode q4101_s3 (888=.), gen (heart_s3)
replace heart_s3=2 if q4101a_s3==997
label values heart_s3 labels1
label variable heart_s3 "Heart disease self-reported"


* MIGRAINE.
recode q4119_s3 (888=.) (999=.) (2=0), gen (migraine_self_s3)
label values migraine_self_s3 labels1
label variable migraine_self_s3 "Migraine self-reported (c2011_w4)"
recode q4119c_s3 (888=.) (2=0), gen (migr_treatment_s3)
label values migr_treatment_s3 labels1
label variable migr_treatment_s3 "Treatment for migraine"
gen migr_s3=.
replace migr_s3=0 if migraine_self_s3==0
replace migr_s3=1 if migraine_self_s3==1 
replace migr_s3=2 if migraine_self_s3==1 & migr_treatment_s3==1
label values migr_s3 labels2
label variable migr_s3 "Migraine self-reported and treatment"


*CHRONIC BACK PAIN
**Lower back pain
recode q4112_s3 (888=.) (999=.) (2=0), gen (lowback_self_s3)
recode q4113c_s3 (888=.) (2=0), gen (low_treatment_s3)
label values (lowback_self_s3 low_treatment_s3) labels1
label variable lowback_self_s3 "Lower back pain self-reported"
label variable low_treatment_s3 "Treatment for lower back pain"
gen lowback_s3=.
replace lowback_s3=0 if lowback_self_s3==0 
replace lowback_s3=1 if lowback_self_s3==1 
replace lowback_s3=2 if lowback_self_s3==1 & low_treatment_s3==1
label values lowback_s3 labels2
label variable lowback_s3 "Lower back pain self-reported and treatment"


* DEMENTIA.
recode q4105_s3 (888=.) (999=.) (2=0), gen (dementia_self_s3)
recode q4106c_s3 (888=.) (2=0), gen (dem_treatment_s3)
label values (dementia_self_s3 dem_treatment_s3) labels1
 label variable dementia_self_s3 "Dementia self-reported (c2011_w4)"
label variable dem_treatment_s3 "Treatment for dementia"
gen dem_s3=.
replace dem_s3=0 if dementia_self_s3==0
replace dem_s3=1 if dementia_self_s3==1 
replace dem_s3=2 if dementia_self_s3==1 & dem_treatment_s3==1
label values dem_s3 labels2
label variable dem_s3 "Dementia self-reported and treatment"
```

```{stata descriptives, cleanlog=FALSE, collectcode=FALSE, results='markup', include=!DOUBLE_CODING}

keep ID_ECS q0007a_result proxy arthritis_s3 osteoart_s3 stroke_s3 angina_s3 diab_s3 lung_s3 asthma_s3 hypertension_s3 cataracts_s3 oral_s3 kidney_s3 digestive_s3 cancer_s3 liver_s3 osteop_s3 anaemia_s3 thyroid_s3 glaucoma_s3 heart_s3 migr_s3 lowback_s3 dem_s3

codebook arthritis_s3 osteoart_s3 stroke_s3 angina_s3 diab_s3 lung_s3 asthma_s3 hypertension_s3 cataracts_s3 oral_s3 kidney_s3 digestive_s3 cancer_s3 liver_s3 osteop_s3 anaemia_s3 thyroid_s3 glaucoma_s3 heart_s3 migr_s3 lowback_s3 dem_s3
```

```{stata save-data-test, eval=TEST}
saveold "Outcome_chronicconditions.dta", replace version(13)
```

```{stata save-data, eval=!TEST}
* Cohorte 2011, ola 4:
saveold "~\UAM\Marta Miret Garcia - Documentacion Edad con Salud\Edad con salud - Ola 4\Outcomes\Cohorte 2011\Outcome datasets\Outcome_chronicconditions.dta", replace version(13)

```

<br>

# Contact person:

-   Name: Lea Francia
-   e-mail: [lea.francia\@inv.uam.es](mailto:lea.francia@inv.uam.es){.email}
-   Phone number: (+34) 914974601

<br>

\< Original version:

-   Name: Emese Verdes-Tennant
-   e-mail: [verdese\@who.int](mailto:nombre.buzon@institucion.org){.email}
-   Phone number: +41 22 791 1428

<br>

-   Name: Beatriz Olaya
-   e-mail: [beatriz.olaya\@pssjd.org](mailto:beatriz.olaya@pssjd.org){.email}
-   Phone number: (+34)936406350 ext(1)2540

# References

::: {#refs}
:::

\newpage

# Session info

```{r, results='markup'}
devtools::session_info()
```
