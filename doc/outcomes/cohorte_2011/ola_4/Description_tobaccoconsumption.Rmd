---
title: "Edad con Salud -- cohort 2011 -- wave 4 -- 'TOBACCO CONSUMPTION'" 
output:
  word_document:
    reference_docx: !expr ecs.data::get_pkg_docx_template()
# bibliography: "`r ecs.data::get_proj_bib_file()`" ## TODO: Borrar esta línea, O BIEN deescomentar esta línea y borrar siguiente UNA VEZ completo el documento
bibliography: ../../../../www/Edad_con_salud_outcome_vars.bib ## TODO: Descomentar esta línea SI se utiliza el gestor bibliográfico, en otro caso BORRAR esta línea
csl: "`r ecs.data::get_proj_csl_file()`"
# nocite: '@<cita_1>, @<cita_2>' ## TODO: Descomentar y añadir cita(s) o borrar campo
editor_options: 
  markdown:
    wrap: 80
params:
  test: true
  double-coding: false
---

```{r setup, include=FALSE}
# Activar los paquetes que R necesita para ejecutar el código:

library(Statamarkdown)

# Ruta al ejecutable de Stata (Ejecuta `sysdir` en Stata para encontrar la ruta)

## TODO: sustituir '<path\to\>' por la ubicación de Stata
##       (ejecutar `sysdir` en Stata) y descomentar línea 62,
##       o eliminar linea 62:
STATA_PATH <- r"(C:/Program Files (x86)/Stata15/StataSE-64.exe)"


# Opciones de configuración de las salidas de R y Stata:

options(width = 88) # Ancho de salida de texto en R

knitr::opts_chunk$set( # Para todos los 'chunks' de código:
  ## TODO: Descomentar si hace falta
  # engine.path = list(stata = STATA_PATH),
  echo        = FALSE, #   - No muestra la sintaxis en el documento
  results     = 'hide',#   - Omite los resultados de ejecutar la sintaxis
  cleanlog    = TRUE,  #   - Omite repetir sintaxis en resultados de Stata
  collectcode = TRUE,  #   - Reutiliza el código de Stata de 'chunks' anteriores
  comment     = ''     #   - No añade ningún prefijo a los resultados
)

TEST          <- params$test
DOUBLE_CODING <- params$`double-coding` & TEST
```

# Variable information

+--------------------+---------------------------------------------+-------------+------------------------+
| Main variable name | Label                                       | Format      | Code                   |
+:===================+:============================================+:============+:=======================+
| tobacco_s3         | Tobacco consumption, categorical (c2011_w4) | Ordinal     | 0 = Never smoked;      |
|                    |                                             |             |                        |
|                    |                                             |             | 1 = Daily smoker;      |
|                    |                                             |             |                        |
|                    |                                             |             | 2 = Smoker, not daily; |
|                    |                                             |             |                        |
|                    |                                             |             | 3 = Not current smoker |
+--------------------+---------------------------------------------+-------------+------------------------+

# Variable description

**Tobacco products** are made entirely or partly of leaf tobacco as raw material, which are intended to be smoked, sucked, chewed or snuffed. All contain the highly addictive psychoactive ingredient, nicotine.

**Tobacco use** is one of the main risk factors for a number of chronic diseases, including cancer, lung diseases, and cardiovascular diseases.

# Explanation of how the variables were created

This variable describes the smoking habit of the participants, including the use of smokeless tobacco. Original variables include `q3001_used_tobac_s3` *(Have you used tobaco?* *(1 = Yes, 2 = No))* and `q3002_use_tobaco_s3` *(Do you use tobaco?)* *(1 = Yes, daily; 2 = Yes, not daily; 3 = No; 4 = The participant said that he/* *she has never smoked before)*

Our final variable has four levels, product of the combination of both variables:

-   0 = Never smoked;if `q3001_used_tobac_s3` == 2 and`q3002_use_tobaco_s3` == 1 & 4
-   1 = Daily smoker; if `q3001_used_tobac_s3`==1 & `q3002_use_tobaco_s3`==1     
-   2 = Smoker, not daily; if `q3001_used_tobac_s3`==1 & `q3002_use_tobaco_s3`==2
-   3 = Not current smoker if `q3001_used_tobac_s3`==1 & `q3002_use_tobaco_s3`==3

# Syntax used to create the variable (Stata 15)

```{stata load-data}
* Cohorte 2011, ola 4:
use "~\UAM\Marta Miret Garcia - Bases de datos maestras Edad con Salud\Ola_4\Cohorte 2011\rawdata_c2011w4.dta"
```

```{stata generate-outcomes, echo=!DOUBLE_CODING}
gen tobacco_s3=.
replace tobacco_s3=0 if q3001_used_tobac_s3==2
replace tobacco_s3=0 if q3001_used_tobac_s3==1 & q3002_use_tobaco_s3==4
replace tobacco_s3=1 if q3001_used_tobac_s3==1 & q3002_use_tobaco_s3==1
replace tobacco_s3=2 if q3001_used_tobac_s3==1 & q3002_use_tobaco_s3==2
replace tobacco_s3=3 if q3001_used_tobac_s3==1 & q3002_use_tobaco_s3==3

label define dTobacco 0 "Never smoked" 1 "Daily smoker" 2 "Smoker, not daily" 3 "Not current smoker"
label values tobacco_s3 dTobacco
label variable tobacco_s3 "Tobacco consumption, categorical (c2011_w4)"
```

<br> 

```{stata descriptives, cleanlog=FALSE, collectcode=FALSE, results='markup', include=!DOUBLE_CODING}
keep ID_ECS q0007a_result proxy tobacco_s3
codebook tobacco_s3
```

```{stata save-data-test, eval=TEST}
saveold "Outcome_tobaccoconsumption.dta", replace version(13)
```

```{stata save-data, eval=!TEST}
* TODO: Descomentar linea correspondiente a la cohorte y ola utilizada
* TODO: Comprobar que la ruta de destino coincide con la localización de `DOC`
* TODO: Sustituir '<variable>' y '<qualifier>' por los valores correspondientes

* Cohorte 2011, ola 1:
* saveold "~\UAM\Marta Miret Garcia - Documentacion Edad con Salud\Edad con salud - Ola 1 - Línea base\Outcomes\Outcome datasets\Outcome_<variable>_<qualifier>.dta", replace version(13) // TODO: Aviso! El acento en "Línea" puede dar problemas con la ruta del archivo

* Cohorte 2011, ola 2:
* saveold "~\UAM\Marta Miret Garcia - Documentacion Edad con Salud\Edad con salud - Ola 2\Outcomes\Outcome datasets\Outcome_<variable>_<qualifier>.dta", replace version(13)

* Cohorte 2011, ola 3:
* saveold "~\UAM\Marta Miret Garcia - Documentacion Edad con Salud\Edad con salud - Ola 3\Outcomes\Cohorte 2011\Outcome datasets\Outcome_<variable>_<qualifier>.dta", replace version(13)

* Cohorte 2011, ola 4:
* saveold "~\UAM\Marta Miret Garcia - Documentacion Edad con Salud\Edad con salud - Ola 4\Outcomes\Cohorte 2011\Outcome datasets\Outcome_<variable>_<qualifier>.dta", replace version(13)

* Cohorte 2019, ola 1:
* saveold "~\UAM\Marta Miret Garcia - Documentacion Edad con Salud\Edad con salud - Ola 3\Outcomes\Cohorte 2019\Outcome datasets\Outcome_<variable>_<qualifier>.dta", replace version(13)

* Cohorte 2019, ola post-confinamiento:
* saveold "~\UAM\Marta Miret Garcia - Documentacion Edad con Salud\Edad con salud - Subestudio COVID\Outcomes\Outcome datasets\Outcome_<variable>_<qualifier>.dta", replace version(13)
```

<br>

# Contact person:

<!--# TODO: Leer párrafo a continuación -->

Incluye tu nombre completo, correo electrónico, teléfono e institución a la que perteneces. Si el algoritmo que has generado ha estado basado en el trabajo que ya había hecho otro/a compañero/a, por favor, indícalo.

<!--# TODO: Borrar párrafo anterior -->

```{=html}
<!--# TODO: Completar '<Nombre y apellidos>', 'nombre.buzon@institucion.org>', y
'<prefijo>' y '<teléfono>' -->
```
-   Name: <Nombre y apellidos>
-   e-mail: [\<nombre.buzon\@institucion.org\>](mailto:nombre.buzon@institucion.org){.email}
-   Phone number: (+<prefijo>) <teléfono>

<br>

<!--# TODO: Completar / eliminar "original version" según corresponda -->

\< Original version:

-   Name: <Nombre y apellidos>
-   e-mail: [\<nombre.buzon\@institucion.org\>](mailto:nombre.buzon@institucion.org){.email}
-   Phone number: (+<prefijo>) <teléfono> \>

# References

<!--# TODO: Leer párrafo a continuación -->

Indica las referencias utilizadas para explicar o generar la/s variable/s. Esta información será igualmente útil para citar apropiadamente en nuestros artículos científicos.

<!--# TODO: Borrar párrafo anterior -->

::: {#refs}
:::

\newpage

<!--# TODO: Leer párrafos a continuación -->

He terminado de generar la/s variable/s.

¡Maravilloso, enhorabuena! Cuando hayas terminado de generar la/s variable/s, por favor, actualiza el documento

```         
[C2011_W4_Planning_outcomes.xlsxl](https://dauam.sharepoint.com/:x:/r/sites/EdadconSalud-OutcomesC2011W4/Documentos compartidos/Outcomes C2011 W4/C2011_W4_Planning_outcomes.xlsx?d=w3e49821bd21047ab8f57ab5837db2393&csf=1&web=1&e=QQRWdn)
```

\*Este documento hace referencia exclusiva a las variables de cohorte 2011, Ola 4.

Así, el/la compañero/a al que le corresponda podrá examinar los distintos archivos y, sobre todo, el algoritmo. En caso de que se detecten inconsistencias, errores o surjan dudas, se te comunicará para proceder con su revisión.

Finalmente, cuando todas las variables estén generadas y revisadas se creará una base de datos común con todas ellas y los datos sociodemográficos principales de los participantes.

<!--# TODO: Borrar párrafos anteriores -->

# Session info

```{r, results='markup'}
devtools::session_info()
```
